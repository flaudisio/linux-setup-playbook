---
# ------------------------------------------------------------------------------
# Helper variables
# ------------------------------------------------------------------------------

__current_user: "{{ lookup('ansible.builtin.env', 'USER') }}"
__templates_dir: "{{ playbook_dir }}/../templates"

# ------------------------------------------------------------------------------
# Tasks configuration
# ------------------------------------------------------------------------------

# base
base_alternatives:
  - name: editor
    path: /usr/bin/vim.basic

# ubuntu-pro
ubuntu_pro_enabled: true
ubuntu_pro_token: "{{ vault_ubuntu_pro_token }}"
ubuntu_pro_upgrade_all_packages: true

ubuntu_pro_enable_services:
  - esm-apps
  - esm-infra

# ulauncher
ulauncher_config:
  hotkey-show-app: <Alt>F1
  show-indicator-icon: false
  theme-name: dark

# git
git_repos:
  - repo: https://github.com/flaudisio/scripts.git
    dest: ~/projects/flaudisio/scripts
    version: main
    update_dest: true
    scripts:
      - pre-commit install
      - cmd: ./install.sh
        changed_stdout: "' -> '"  # 'ln' output

# dotfiles
dotfiles_repo_local_dest: ~/projects/flaudisio/dotfiles

dotfiles_extra_dirs:
  - ~/.bashrc.d

dotfiles_vim_plugins:
  - https://github.com/editorconfig/editorconfig-vim.git
  - https://github.com/hashivim/vim-terraform.git

dotfiles_post_commands:
  # Ref: https://pre-commit.com/#automatically-enabling-pre-commit-on-repositories
  - cmd: pre-commit init-templatedir ~/.git-template
    creates: ~/.git-template

# resticprofile
resticprofile_symlink_name: rp

resticprofile_config_templates:
  - src: "{{ __templates_dir }}/resticprofile/.env.j2"
    sensitive: true
  - src: "{{ __templates_dir }}/resticprofile/repo-password.txt.j2"
    sensitive: true
  - "{{ __templates_dir }}/resticprofile/excludes.txt.j2"
  - "{{ __templates_dir }}/resticprofile/includes.txt.j2"
  - "{{ __templates_dir }}/resticprofile/send-after-fail.body.json.j2"
  - "{{ __templates_dir }}/resticprofile/systemd-working-directory.conf.j2"
  - "{{ __templates_dir }}/resticprofile/profiles.yaml.j2"

__rp_default_profile: main

resticprofile_enable_schedules:
  - "{{ __rp_default_profile }}"

# firefox
firefox_set_as_default_browser: true

# mise
mise_enable_upgrade: false
mise_bashrc_file: ~/.bashrc.d/mise.bash
mise_activate_command: mise activate bash --shims

# docker
docker_users:
  - "{{ __current_user }}"

docker_daemon_options:
  # Change the default IPAM config to avoid overlapping production networks that use the 172.16/12 range
  # Ref: https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file
  bip: 192.168.243.1/24
  default-address-pools:
    # Ref: ipcalc-ng 192.168.244.0/22 -S 27
    - base: 192.168.244.0/22
      size: 27

# kvm
kvm_install_server_packages: true
kvm_install_virt_manager: true
kvm_install_client_utilities: true

kvm_users:
  - "{{ __current_user }}"

kvm_disable_libvirt_qemu_security_driver: true

# packages - APT
packages_apt_install:
  # Base
  - apt-transport-https
  - bash-completion
  - ca-certificates
  - curl
  - dkms
  - tmux
  - tree
  # Secrets management
  - keepassxc
  - makepasswd
  - seahorse
  # Development
  - gedit
  - gedit-plugins
  - jq
  - vim
  # Sysadmin
  - arping
  - exfat-fuse
  - exfatprogs
  - htop
  - iotop
  - iptraf-ng
  - lm-sensors
  - lshw
  - lsof
  - mtr-tiny
  - netcat-openbsd
  - nmap
  - openssh-client
  - rsync
  - traceroute
  - whois
  # Media
  - flameshot
  - fonts-dejavu
  - fonts-dejavu-extra
  - fonts-firacode
  - fonts-inconsolata
  - fonts-liberation
  - fonts-liberation2
  - fonts-noto-color-emoji
  - gimp
  - gpick
  - graphviz
  - qt5-style-plugins
  - peek
  - playerctl
  - ristretto
  - shotwell
  - vlc
  - vlc-plugin-notify
  # Utilities
  - ack
  - atool
  - atril
  - mate-calc
  - dconf-editor
  - dos2unix
  - engrampa
  - gvfs-backends
  - ipcalc-ng
  - moreutils
  - multitail
  - p7zip-full
  - p7zip-rar
  - pbzip2
  - pigz
  - printer-driver-cups-pdf
  - rename
  - sqlite3
  - transmission-qt
  - unar
  - unrar
  - unzip
  - wmctrl
  - xclip
  - xdotool
  - zenity

packages_apt_remove:
  - command-not-found
  - gnome-software
  - gnome-software-common
  - gnome-software-plugin-snap
  - gnumeric
  - hexchat
  - motd-news-config
  - mousepad
  - sgt-launcher
  - sgt-puzzles
  - thunderbird
  - unattended-upgrades
  - xfburn
  - xul-ext-ubufox

packages_apt_autoremove: true

# packages - snap
packages_snap_remove_snapd: true

# packages - pipx
packages_pipx_install:
  - name: pre-commit
    state: latest
  - name: ps-mem
    state: latest
    global: true

# packages - config files
packages_config_files:
  - path: ~/.config/flameshot/flameshot.ini
    content: |
      [General]
      contrastOpacity=188
      disabledTrayIcon=true
      drawColor=#ff0000
      drawThickness=3
      savePath={{ ("~/" + xubuntu_xdg_download_dir) | expanduser }}

# xubuntu - autostart
xubuntu_autostart_disable_apps:
  - blueman
  - update-notifier

# xubuntu - XDG user dirs
xubuntu_xdg_documents_dir: library/Documents
xubuntu_xdg_download_dir: cache
xubuntu_xdg_music_dir: library/Music
xubuntu_xdg_pictures_dir: library/Pictures
xubuntu_xdg_publicshare_dir: library/Public
xubuntu_xdg_templates_dir: library/Templates
xubuntu_xdg_videos_dir: library/Videos

# xubuntu - bookmarks
xubuntu_bookmarks:
  - ~/{{ xubuntu_xdg_download_dir }}
  - ~/projects

# xubuntu - keyboard shortcuts
# Note: <Primary> means <Ctrl>
xubuntu_remove_keyboard_shortcuts:
  - <Alt>F1
  - <Alt>F3
  - <Alt>Print
  - <Primary>Escape
  - <Primary><Alt>t
  - <Primary><Alt>Escape
  - <Super>f
  - XF86Messenger

xubuntu_keyboard_shortcuts:
  # Audio
  - shortcut: <Primary><Super>Down
    cmd: amixer -q -M -D pulse sset Master 5%-
  - shortcut: <Primary><Super>Up
    cmd: amixer -q -M -D pulse sset Master 5%+
  # Spotify
  - shortcut: XF86Music
    cmd: spotify
  - shortcut: <Super>r
    cmd: spotify
  - shortcut: <Primary><Super>Insert
    cmd: playerctl play-pause
  - shortcut: <Primary><Super>Left
    cmd: playerctl previous
  - shortcut: <Primary><Super>Right
    cmd: playerctl next
  # Screenshot
  - shortcut: Print
    cmd: xfce4-screenshooter -f
  - shortcut: <Shift>Print
    cmd: xfce4-screenshooter -w
  - shortcut: <Super>Print
    cmd: flameshot gui
  # User session
  - shortcut: <Primary><Alt>Delete
    cmd: xfce4-session-logout
  - shortcut: <Primary><Alt>l
    cmd: xflock4
  # Window Manager
  - shortcut: <Primary><Alt>Left
    cmd: move-to-next-monitor
  - shortcut: <Primary><Alt>Right
    cmd: move-to-next-monitor
  # Xfce tools
  - shortcut: <Super>F1
    cmd: xfce4-find-cursor
  - shortcut: <Super>p
    cmd: xfce4-display-settings --minimal
  - shortcut: <Super>z
    cmd: xfce4-popup-applicationsmenu
  # Terminal
  - shortcut: <Super>Return
    cmd: xfce4-terminal --maximize
  - shortcut: <Super>KP_Enter
    cmd: xfce4-terminal --maximize
  # Utilities
  - shortcut: <Super>e
    cmd: exo-open --launch FileManager
  - shortcut: <Super>k
    cmd: keepassxc
  - shortcut: <Super>n
    cmd: code {{ xubuntu_home_dir }}/notes
  - shortcut: <Super>t
    cmd: exo-open --launch TerminalEmulator
  - shortcut: <Super>w
    cmd: sensible-browser https://keep.google.com

xubuntu_remove_window_manager_shortcuts:
  - <Alt>F7
  - <Alt>F9
  - <Primary>F1
  - <Primary>F2
  - <Primary>F3
  - <Primary>F4
  - <Primary>F5
  - <Primary>F6
  - <Primary>F7
  - <Primary>F8
  - <Primary>F9
  - <Primary>F10
  - <Primary>F11
  - <Primary>F12
  - <Primary><Alt>Up
  - <Primary><Alt>Down
  - <Primary><Alt>Left
  - <Primary><Alt>Right

xubuntu_window_manager_shortcuts:
  - shortcut: <Super>d
    cmd: show_desktop_key
  - shortcut: <Super>s
    cmd: hide_window_key
  - shortcut: <Super>Up
    cmd: maximize_window_key

# xubuntu - theme
xubuntu_theme_packages:
  - greybird-gtk-theme
  - oxygen-cursor-theme

xubuntu_system_theme: Greybird-dark
xubuntu_cursor_theme: oxy-zion

# xubuntu - fonts
xubuntu_fonts_packages:
  - fonts-dejavu-core
  - fonts-noto-core
  - fonts-noto-mono

xubuntu_fonts_archives:
  - name: JetBrainsMono
    url: https://github.com/JetBrains/JetBrainsMono/releases/download/v2.304/JetBrainsMono-2.304.zip
    include_files:
      - fonts/*

xubuntu_system_default_font: Noto Sans 9
xubuntu_system_monospace_font: DejaVu Sans Mono 10
xubuntu_window_title_font: Noto Sans Bold 9

# xubuntu - Thunar
xubuntu_thunar_settings:
  - property: /last-location-bar
    value: ThunarLocationButtons
    value_type: string
  - property: /last-menubar-visible
    value: "false"
    value_type: bool
  - property: /last-restore-tabs
    value: "false"
    value_type: bool
  - property: /last-sort-column
    value: THUNAR_COLUMN_NAME
    value_type: string
  - property: /last-sort-order
    value: GTK_SORT_ASCENDING
    value_type: string
  - property: /last-view
    value: ThunarDetailsView
    value_type: string
  - property: /last-window-maximized
    value: "true"
    value_type: bool
  - property: /misc-change-window-icon
    value: "true"
    value_type: bool
  - property: /misc-confirm-close-multiple-tabs
    value: "false"
    value_type: bool
  - property: /misc-date-style
    value: THUNAR_DATE_STYLE_LONG
    value_type: string
  - property: /misc-full-path-in-title
    value: "false"
    value_type: bool
  - property: /misc-open-new-window-as-tab
    value: "true"
    value_type: bool
  - property: /misc-thumbnail-mode
    value: THUNAR_THUMBNAIL_MODE_ONLY_LOCAL
    value_type: string
  - property: /misc-folders-first
    value: "true"
    value_type: bool
  - property: /misc-volume-management
    value: "false"
    value_type: bool
  - property: /shortcuts-icon-size
    value: THUNAR_ICON_SIZE_24
    value_type: string

# xubuntu - xfce4-terminal
xubuntu_xfce4_terminal_settings:
  - property: /background-mode
    value: TERMINAL_BACKGROUND_SOLID
    value_type: string
  - property: /color-background
    value: "#000000"
    value_type: string
  - property: /color-background-vary
    value: "false"
    value_type: bool
  - property: /color-bold-is-bright
    value: "true"
    value_type: bool
  - property: /color-bold-use-default
    value: "true"
    value_type: bool
  - property: /color-cursor
    value: "#10bec1b403df"
    value_type: string
  - property: /color-cursor-foreground
    value: "#777776767b7b"
    value_type: string
  - property: /color-cursor-use-default
    value: "false"
    value_type: bool
  - property: /color-foreground
    value: "#ffffff"
    value_type: string
  - property: /color-palette
    value: "#000000;#aa0000;#00aa00;#aa5500;#0000aa;#aa00aa;#00aaaa;#aaaaaa;#555555;#ff5555;#55ff55;#ffff55;#5555ff;#ff55ff;#55ffff;#ffffff"
    value_type: string
  - property: /color-selection-use-default
    value: "true"
    value_type: bool
  - property: /color-use-theme
    value: "false"
    value_type: bool
  - property: /font-name
    value: DejaVu Sans Mono 11
    value_type: string
  - property: /misc-borders-default
    value: "false"
    value_type: bool
  - property: /misc-menubar-default
    value: "false"
    value_type: bool
  - property: /misc-new-tab-adjacent
    value: "true"
    value_type: bool
  - property: /scrolling-bar
    value: TERMINAL_SCROLLBAR_NONE
    value_type: string
  - property: /scrolling-on-output
    value: "true"
    value_type: bool
  - property: /scrolling-unlimited
    value: "true"
    value_type: bool
  - property: /tab-activity-color
    value: "#65b0ffff3777"
    value_type: string
  - property: /text-blink-mode
    value: TERMINAL_TEXT_BLINK_MODE_ALWAYS
    value_type: string
  - property: /title-mode
    value: TERMINAL_TITLE_REPLACE
    value_type: string

# xubuntu - Xfconf
xubuntu_xfconf_settings:
  # Desktop
  - channel: xfce4-desktop
    property: /desktop-icons/style
    value: "0"
    value_type: int
  - channel: xfce4-desktop
    property: /desktop-menu/show
    value: "true"
    value_type: bool
  - channel: xfce4-desktop
    property: /desktop-menu/show-icons
    value: "true"
    value_type: bool
  - channel: xfce4-desktop
    property: /windowlist-menu/show
    value: "false"
    value_type: bool
  # Screensaver
  - channel: xfce4-screensaver
    property: /lock/saver-activation/delay
    value: "5"
    value_type: int
  - channel: xfce4-screensaver
    property: /saver/enabled
    value: "true"
    value_type: bool
  - channel: xfce4-screensaver
    property: /saver/fullscreen-inhibit
    value: "true"
    value_type: bool
  - channel: xfce4-screensaver
    property: /saver/idle-activation/delay
    value: "15"
    value_type: int
  - channel: xfce4-screensaver
    property: /saver/mode
    value: "0"  # Blank screen
    value_type: int
  # Power Manager
  - channel: xfce4-power-manager
    property: /xfce4-power-manager/power-button-action
    value: "0"  # Ask what to do
    value_type: int
  # Window Manager
  - channel: xfwm4
    property: /general/button_layout
    value: CMH|O
    value_type: string

# xubuntu - default apps
xubuntu_default_web_browser: firefox
